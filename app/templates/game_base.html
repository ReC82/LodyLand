<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}LodyLand{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap pour le layout g√©n√©ral des lands -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />

    <!-- CSS global du jeu -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='GAME_UI/css/game.css') }}"
    />

    {% block extra_css %}{% endblock %}

    <!-- CSS sp√©cifique aux lands -->
    <link rel="stylesheet" href="{{ url_for('static', filename='GAME_UI/css/lands.css') }}">

  </head>
  <body class="{% block body_class %}game-body{% endblock %}">
    <!-- HUD joueur -->
    <header class="game-header">
      <div class="gh-left">
        <div class="gh-logo">
          <img
            src="{{ url_for('static', filename='assets/img/ui/logo_hud.png') }}"
            alt="LodyLand"
            class="gh-logo-img"
          />
        </div>
</div>

      <div class="gh-center">
        <div class="gh-xp-label">
          Niveau <span id="hud-level">0</span>
        </div>
        <div class="gh-xp-bar">
          <div class="gh-xp-fill" id="hud-xp-fill"></div>
        </div>
        <div class="gh-xp-text">
          <span id="hud-xp-current">0</span> /
          <span id="hud-xp-next">100</span> XP
        </div>
      </div>

      <div class="gh-right">
       
        <div class="gh-currency gh-coins">
          <img
            src="{{ url_for('static', filename='assets/img/ui/coins.png') }}"
            alt="Coins"
            class="hud-icon-small"
          />
          <span id="hud-coins">0</span>
        </div>
        <div class="gh-currency gh-diams">
          <img
            src="{{ url_for('static', filename='assets/img/ui/diams.png') }}"
            alt="Diamants"
            class="hud-icon-small"
          />
          <span id="hud-diams">0</span>
        </div>
        <!-- Daily Chest (icon HUD) -->
        <div class="hud-daily" id="hudDaily">
          <div class="hud-daily-icon" id="dailyIcon" onclick="claimDaily()">
            <img
              src="{{ url_for('static', filename='assets/img/ui/chest.png') }}"
              alt="Daily Chest"
              class="hud-icon-img"
            />
            <span id="dailyAlert" class="daily-alert-badge">!</span>
          </div>
          <div class="hud-daily-tooltip" id="dailyTooltip">
            Chargement...
          </div>
        </div>
       
        <button class="gh-menu-btn" id="hud-menu-btn" type="button">‚ò∞</button>
      </div>
    </header>

    <!-- Menu joueur d√©roulant -->
      <div class="game-menu" id="game-menu">
      <div class="game-menu-card">
        <div class="game-menu-header">
          <div class="game-menu-title">Menu</div>
          <button
            class="game-menu-close"
            id="game-menu-close"
            type="button"
            aria-label="Fermer le menu"
          >
            ‚úï
          </button>
        </div>

        <div class="game-menu-section">
          <button class="game-menu-item" data-action="profile">
            Profil (WIP)
          </button>
          <button class="game-menu-item" data-action="lands">
            Lands
          </button>
          <button class="game-menu-item" data-action="shop">
            Boutique
          </button>
          <button class="game-menu-item" data-action="quests">
            Qu√™tes (WIP)
          </button>
          <button class="game-menu-item" data-action="inventory">
            Inventaire
          </button>          
        </div>

        <div class="game-menu-section">
          <button class="game-menu-item game-menu-logout" data-action="logout">
            Se d√©connecter
          </button>
        </div>
      </div>
    </div>


    <!-- Contenu principal (lands, etc.) -->
    <main class="game-main">
      {% block content %}{% endblock %}
    </main>

    <!-- Daily Chest modal -->
    <div id="dailyModal" class="daily-modal">
      <div class="daily-modal-backdrop"></div>
      <div class="daily-modal-box">
        <div class="daily-modal-icon">üéÅ</div>
        <h2 class="daily-modal-title">Coffre ouvert !</h2>
        <p class="daily-modal-reward">
          Tu re√ßois <span id="dailyModalReward">0</span> coins.
        </p>
        <p class="daily-modal-streak">
          Streak actuel : <span id="dailyModalStreakCurrent">0</span><br />
          Meilleur streak : <span id="dailyModalStreakBest">0</span>
        </p>
        <button id="dailyModalClose" class="daily-modal-close">
          OK
        </button>
      </div>
    </div>

    <!-- Level Up modal -->
    <div id="levelUpModal" class="daily-modal levelup-modal">
      <div class="daily-modal-backdrop" id="levelUpModalBackdrop"></div>
      <div class="daily-modal-box">
        <div class="daily-modal-icon">‚≠ê</div>
        <h2 class="daily-modal-title">
          Niveau <span id="levelUpModalLevel">1</span> atteint !
        </h2>

        <div class="levelup-modal-rewards" id="levelUpModalRewards">
          <!-- Filled dynamically with reward items -->
        </div>

        <button id="levelUpModalClose" class="daily-modal-close">
          OK
        </button>
      </div>
    </div>

    <!-- ===========================
        Craft Modal
        =========================== -->
    <div id="craft-modal" class="craft-modal">
      <div class="craft-modal-backdrop"></div>

      <div class="craft-modal-box">
        <!-- Header -->
        <div class="craft-modal-header">
          <h2 class="craft-modal-title">Table de craft</h2>
          <div class="craft-modal-header-actions">
            <button
              id="craft-recipes-toggle-btn"
              class="craft-recipes-toggle-btn"
              title="Voir les recettes"
            >
              üìñ
            </button>
            <button id="craft-close-btn" class="craft-close-btn">‚úï</button>
          </div>
        </div>

        <div class="craft-modal-body">
          <!-- Left: ingredients + (recipes via toggle) -->
          <div class="craft-left-panel">
            <!-- Ingr√©dients du joueur -->
            <div class="craft-ingredients-panel" id="craft-ingredients-panel">
              <h3 class="craft-section-title">Ingr√©dients disponibles</h3>
              <div id="craft-ingredients-list" class="craft-ingredients-list">
                <!-- JS: resources du joueur -->
              </div>
            </div>

            <!-- Recettes (affich√©es uniquement quand on clique sur le livre) -->
            <div
              class="craft-recipes-panel"
              id="craft-recipes-panel"
              style="display:none;"
            >
              <h3 class="craft-section-title">Recettes</h3>
              <div id="craft-recipes-list" class="craft-recipes-list"></div>
            </div>
          </div>


          <!-- Center: craft grid (pour l'instant juste 3 cases) -->
          <div class="craft-grid-panel">
            <h3 class="craft-section-title">
              Table (niveau <span id="craft-table-level">1</span>)
            </h3>

            <div class="craft-grid">
              <div class="craft-slot" data-slot="0"></div>
              <div class="craft-slot" data-slot="1"></div>
              <div class="craft-slot" data-slot="2"></div>
            </div>

            <div class="craft-quantity-row">
              <label for="craft-quantity-input">Quantit√©</label>
              <input
                id="craft-quantity-input"
                type="number"
                min="1"
                value="1"
                step="1"
              />
            </div>

            <button id="craft-perform-btn" class="craft-perform-btn" disabled>
              Crafte
            </button>

            <div id="craft-success" class="craft-success-msg" style="display:none;"></div>
            <div id="craft-error" class="craft-error-msg" style="display:none;"></div>
          </div>
          
        </div>
      </div>
    </div>


    <!-- HUD bottom-left actions -->
    <div class="hud-bottom-left">
      <!-- autres boutons √©ventuels... -->
      <button
        id="craft-open-btn"
        class="craft-fab-btn"
        title="Table de craft"
      >
        <img
          src="{{ url_for('static', filename='assets/img/ui/craft.png') }}"
          alt="Craft"
        />
      </button>
    </div>
    
    <!-- JS commun -->
    <script src="{{ url_for('static', filename='common.js') }}"></script>
    <script src="{{ url_for('static', filename='GAME_UI/js/game_menu.js') }}"></script>
    <script src="{{ url_for('static', filename='GAME_UI/js/game_app.js') }}"></script>
    <script src="{{ url_for('static', filename='GAME_UI/js/craft_app.js') }}"></script>

    {# Scripts sp√©cifiques √† certaines pages (shop, lands sp√©ciaux, etc.) #}
    {% block extra_scripts %}{% endblock %}
  </body>
</html>
