{% extends "dev_base.html" %}

{% block title %}Debug UI{% endblock %}

{% block content %}
<div class="container my-4">
  <h1 class="mb-4">Debug UI</h1>

  <!-- Auth / Register / Login -->
  <section class="mb-4">
    <h2 class="h5">Auth</h2>
    <div class="row g-2 align-items-center mb-2">
      <div class="col-auto">
        <input
          id="playerName"
          class="form-control form-control-sm"
          type="text"
          placeholder="Nom du joueur (player1)"
        >
      </div>
      <div class="col-auto d-flex gap-2">
        <button class="btn btn-sm btn-primary" onclick="register()">Register</button>
        <button class="btn btn-sm btn-outline-primary" onclick="login()">Login</button>
        <button class="btn btn-sm btn-outline-secondary" onclick="logout()">Logout</button>
      </div>
    </div>
    <div id="authBox" class="small text-muted">
      Non connecté.
    </div>
  </section>

  <!-- Player info + barre d'XP -->
  <section class="mb-4">
    <h2 class="h5">Player</h2>
    <div id="playerBox" class="mb-2 small">
      Aucun player.
    </div>

    <div class="progress" style="height: 20px;">
      <div
        id="progressFill"
        class="progress-bar"
        role="progressbar"
        style="width: 0%;"
        aria-valuemin="0"
        aria-valuemax="100"
      ></div>
    </div>
    <div class="d-flex justify-content-between small mt-1">
      <span id="progressTextLeft">XP: 0</span>
      <span id="progressTextRight">0%</span>
    </div>
  </section>

  <!-- Unlock tiles -->
  <section class="mb-4">
    <h2 class="h5">Tiles / Unlock</h2>
    <div class="row g-2 align-items-center mb-2">
      <div class="col-auto">
        <label for="resource" class="form-label small mb-0">Ressource</label>
        <select id="resource" class="form-select form-select-sm"></select>
      </div>
      <div class="col-auto">
        <button
          id="unlockBtn"
          class="btn btn-sm btn-warning mt-3"
          onclick="unlockTile()"
        >
          Unlock tile
        </button>
      </div>
      <div class="col small mt-3" id="resInfo">
        —
      </div>
    </div>

    <pre id="tilesBox" class="small bg-white border rounded p-2 mb-0">
Aucune tuile.
    </pre>
  </section>

  <!-- Collect manuel par ID -->
  <section class="mb-4">
    <h2 class="h5">Collect (par ID)</h2>
    <div class="row g-2 align-items-center mb-2">
      <div class="col-auto">
        <input
          id="tileId"
          class="form-control form-control-sm"
          type="number"
          placeholder="tile id"
        >
      </div>
      <div class="col-auto">
        <button
          id="collectBtn"
          class="btn btn-sm btn-danger"
          onclick="collect()"
        >
          Collect
        </button>
      </div>
      <div class="col small" id="collectBox">
        Prêt.
      </div>
    </div>
  </section>

  <!-- Inventory + shop + daily + state + grid -->
  <section class="mb-4">
    <h2 class="h5">Inventory</h2>
    <div id="inventoryBox" class="row row-cols-2 row-cols-md-4 g-2">
      <div class="col">
        <div class="text-muted small">Inventaire vide.</div>
      </div>
    </div>
  </section>

  <!-- Cartes du joueur -->
<section class="mb-4">
  <h2 class="h5">Cartes du joueur</h2>
  <div id="cardDevStatus" class="small text-muted mb-2">
    Chargez un joueur pour voir ses cartes.
  </div>
  <div class="table-responsive">
    <table class="table table-dark table-sm align-middle">
      <thead>
        <tr>
          <th>Icon</th>
          <th>Key</th>
          <th>Label</th>
          <th>Type</th>
          <th>Target</th>
          <th>Owned</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="cardDevTable">
        <tr>
          <td colspan="7" class="text-center text-muted">Aucune donnée</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>


  <section class="mb-4">
    <h2 class="h5">Shop / Sell</h2>
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <input
          id="sellResource"
          class="form-control form-control-sm"
          type="text"
          placeholder="resource key (wood...)"
        >
      </div>
      <div class="col-auto">
        <input
          id="sellQty"
          class="form-control form-control-sm"
          type="number"
          placeholder="qty"
        >
      </div>
      <div class="col-auto">
        <button class="btn btn-sm btn-outline-success" onclick="sell()">Sell</button>
      </div>
    </div>
  </section>

  <section class="mb-4">
    <h2 class="h5">Daily chest</h2>
    <div class="row g-2 align-items-center">
      <div class="col-auto">
        <button id="dailyBtn" class="btn btn-sm btn-info" onclick="claimDaily()">
          Claim daily
        </button>
      </div>
      <div class="col small" id="dailyBox">
        Non réclamé.
      </div>
    </div>
  </section>

  <section class="mb-4">
    <h2 class="h5">Game state (JSON brut)</h2>
    <pre
      id="gameStateBox"
      class="small bg-white border rounded p-2"
      style="max-height: 260px; overflow:auto;"
    >
Clique sur "Load game state" dans la console ou on branchera un bouton plus tard.
    </pre>
  </section>

  <section class="mb-4">
    <h2 class="h5">Gameplay Grid</h2>
    <div id="gridBox" class="row row-cols-2 row-cols-md-4 g-2">
      <div class="col">
        <div class="text-muted small">Aucune tuile débloquée.</div>
      </div>
    </div>
  </section>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='DEV_UI/js/dev_app.js') }}"></script>
{% endblock %}
